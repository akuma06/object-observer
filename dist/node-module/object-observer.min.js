const e=new Map,t=new Map,o=new Map,r=["Date","Blob","Number","String","Boolean","Error","SyntaxError","TypeError","URIError","Function","Promise","RegExp"];function n(e){return r.indexOf(e.constructor.name)>=0}function l(r,n){let l,f=t.get(r),i=o.get(f.root);return l="pop"===n?function(){let o,l,a;return o=r.length-1,l=Reflect.apply(r[n],r,arguments),(a=e.get(l))&&t.get(a).revoke(),i.notify([new u(f.path.concat(o),a||l)]),a||l}:"push"===n?function(){let e,t,o,l=[];e=Array.from(arguments),o=r.length;for(let t,r=0,n=e.length;r<n;r++)(t=e[r])&&"object"==typeof t&&(e[r]=new a(t,o+r,f).proxy),l.push(new p(f.path.concat(o+r),t));return t=Reflect.apply(r[n],r,e),i.notify(l),t}:"shift"===n?function(){let o,l;o=Reflect.apply(r[n],r,arguments),(l=e.get(o))&&t.get(l).revoke();for(let o,n,l=0,f=r.length;l<f;l++)(o=r[l])&&"object"==typeof o&&((n=t.get(e.get(o)))?n.ownKey=l:console.error("unexpectedly failed to resolve proxy -> target -> observed"));return i.notify([new u(f.path.concat(0),l||o)]),l||o}:"unshift"===n?function(){let o,l,c,s=[];(o=Array.from(arguments)).forEach((e,t)=>{e&&"object"==typeof e&&(o[t]=new a(e,t,f).proxy)}),l=Reflect.apply(r[n],r,o);for(let o,n=0,l=r.length;n<l;n++)(o=r[n])&&"object"==typeof o&&((c=t.get(e.get(o)))?c.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));for(let e=0,t=o.length;e<t;e++)s.push(new p(f.path.concat(e),r[e]));return i.notify(s),l}:"reverse"===n?function(){let o;Reflect.apply(r[n],r,arguments);for(let n,l=0,f=r.length;l<f;l++)(n=r[l])&&"object"==typeof n&&((o=t.get(e.get(n)))?o.ownKey=l:console.error("failed to resolve proxy -> target -> observed"));return i.notify([new function(){Object.defineProperties(this,{type:{value:"reverse"}})}]),this}:"sort"===n?function(){let o;Reflect.apply(r[n],r,arguments);for(let n,l=0,f=r.length;l<f;l++)(n=r[l])&&"object"==typeof n&&((o=t.get(e.get(n)))?o.ownKey=l:console.error("failed to resolve proxy -> target -> observed"));return i.notify([new function(){Object.defineProperties(this,{type:{value:"shuffle"}})}]),this}:"fill"===n?function(){let o,l,c,u=[],y=arguments.length,h=r.length;o=y<2?0:arguments[1]<0?h+arguments[1]:arguments[1],l=y<3?h:arguments[2]<0?h+arguments[2]:arguments[2],c=r.slice(),Reflect.apply(r[n],r,arguments);for(let n,i,y=o;y<l;y++)(n=r[y])&&"object"==typeof n&&(r[y]=new a(n,y,f).proxy),c.hasOwnProperty(y)?((i=e.get(c[y]))&&t.get(i).revoke(),u.push(new s(f.path.concat(y),r[y],i||c[y]))):u.push(new p(f.path.concat(y),r[y]));return i.notify(u),this}:"splice"===n?function(){let o,l,c,y,h,v,b,g,w=[],d=r.length;b=(o=Array.from(arguments)).length;for(let e,t=0;t<b;t++)e=o[t],t>1&&e&&"object"==typeof e&&(o[t]=new a(e,t,f).proxy);y=0===b?0:o[0]<0?d+o[0]:o[0],h=b<2?d-y:o[1],v=Math.max(b-2,0),l=Reflect.apply(r[n],r,o),d=r.length;for(let o,n=0;n<d;n++)(o=r[n])&&"object"==typeof o&&((c=t.get(e.get(o)))?c.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));for(let o,r,n=0,f=l.length;n<f;n++)o=l[n],(r=e.get(o))&&(t.get(r).revoke(),l[n]=r);for(g=0;g<h;g++)g<v?w.push(new s(f.path.concat(y+g),r[y+g],l[g])):w.push(new u(f.path.concat(y+g),l[g]));for(;g<v;g++)w.push(new p(f.path.concat(y+g),r[y+g]));return i.notify(w),l}:Reflect.get(r,n)}function f(r,l,f){let i,c,u=r.hasOwnProperty(l),y=r[l],h=t.get(r),v=o.get(h.root);if((i=f&&"object"==typeof f&&!n(f)?Reflect.set(r,l,new a(f,l,h).proxy):Reflect.set(r,l,f))&&((c=e.get(y))&&t.get(c).revoke(),v.hasListeners()&&!h.preventCallbacks)){let e=h.path.concat(l);v.notify([u?new s(e,f,c||y):new p(e,f)])}return i}function i(r,n){let l,f,i=r[n],a=t.get(r),c=o.get(a.root);if((l=Reflect.deleteProperty(r,n))&&((f=e.get(i))&&t.get(f).revoke(),c.hasListeners()&&!a.preventCallbacks)){let e=a.path.concat(n);c.notify([new u(e,f||i)])}return l}function a(o,r,c){let p,s,u;var y;y=o,p=Array.isArray(y)?y.slice():Object.assign({},y),Array.isArray(p)?(!function(e,t){for(let o,r=0,l=e.length;r<l;r++)(o=e[r])&&"object"==typeof o&&!n(o)&&(e[r]=new a(o,r,t).proxy)}(p,this),s=Proxy.revocable(p,{set:f,get:l,deleteProperty:i})):(!function(e,t){let o=Object.keys(e);for(let r,l,f=0,i=o.length;f<i;f++)(l=e[r=o[f]])&&"object"==typeof l&&!n(l)&&(e[r]=new a(l,r,t).proxy)}(p,this),s=Proxy.revocable(p,{set:f,deleteProperty:i})),u=s.proxy,t.set(p,this),e.set(u,p),Object.defineProperties(this,{revokable:{value:s},proxy:{value:u},parent:{value:c},ownKey:{value:r,writable:!0}})}function c(e){let t=!1,o=[];Object.defineProperties(e.proxy,{observe:{value:function(e){if(t)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");o.indexOf(e)<0?o.push(e):console.info("observer (callback) may be bound to an observable only once")}},unobserve:{value:function(){if(t)throw new TypeError("revoked Observable MAY NOT be unobserved anymore");if(arguments.length)for(let e,t=0,r=arguments.length;t<r;t++)(e=o.indexOf(arguments[t]))>=0&&o.splice(e,1);else o.splice(0,o.length)}},revoke:{value:function(){t?console.log("revoking of Observable effective only once"):(t=!0,e.revoke())}}}),Object.defineProperties(this,{hasListeners:{value:function(){return o.length>0}},notify:{value:function(e){for(let t,r=0,n=o.length;r<n;r++){t=o[r];try{t(e)}catch(e){console.error("one/some of the observing callbacks failed with ",e)}}}}})}function p(e,t){Object.defineProperties(this,{type:{value:"insert"},path:{value:e},value:{value:t}})}function s(e,t,o){Object.defineProperties(this,{type:{value:"update"},path:{value:e},value:{value:t},oldValue:{value:o}})}function u(e,t){Object.defineProperties(this,{type:{value:"delete"},path:{value:e},oldValue:{value:t}})}module.exports=c,Object.defineProperty(a.prototype,"root",{get:function(){let e=this;for(;e.parent;)e=e.parent;return e}}),Object.defineProperty(a.prototype,"path",{get:function(){let e=[],t=this;for(;void 0!==t.ownKey;)e.unshift(t.ownKey),t=t.parent;return e}}),Object.defineProperty(a.prototype,"revoke",{value:function(){let o=e.get(this.proxy),r=Object.keys(o);this.revokable.revoke();for(let n,l,f=0,i=r.length;f<i;f++)n=r[f],(l=e.get(o[n]))&&(o[n]=t.get(l).revoke());return e.delete(this.proxy),t.delete(o),o}}),Object.defineProperty(c,"from",{value:function(e){if(!e||"object"!=typeof e)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in e||"unobserve"in e||"revoke"in e)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(n(e))throw new Error(e+" found to be one of non-observable object types: "+r);let t=new a(e),l=new c(t);return o.set(t,l),t.proxy}}),Object.freeze(c);