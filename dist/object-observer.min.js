(()=>{"use strict";const e=this||window,t=new Map,o=new WeakMap,r=new WeakMap,n={Date:!0,Blob:!0,Number:!0,String:!0,Boolean:!0,Error:!0,SyntaxError:!0,TypeError:!0,URIError:!0,Function:!0,Promise:!0,RegExp:!0};function l(e){return n.hasOwnProperty(e.constructor.name)}function a(e,n){let l,a=o.get(e),f=r.get(a.root);return l="pop"===n?function(){let r,l,p;r=e.length-1,l=Reflect.apply(e[n],e,arguments),(p=t.get(l))&&(o.get(p).revoke(),l=p);let i,s=a.path,c=s.length,y=new Array(c+1);for(i=0;i<c;i++)y[i]=s[i];return y[c]=r,f.notify([{type:"delete",path:y,oldValue:l}]),l}:"push"===n?function(){let t,o,r,l,p=arguments.length,s=new Array(p),c=[],y=a.path,h=y.length;o=e.length;for(let e,t=0;t<p;t++){for((e=arguments[t])&&"object"==typeof e&&(e=new i(e,o+t,a).proxy),s[t]=e,l=new Array(h+1),r=0;r<h;r++)l[t]=y[r];l[h]=o+t,c[t]={type:"insert",path:l,value:e}}return t=Reflect.apply(e[n],e,s),f.notify(c),t}:"shift"===n?function(){let r,l;r=Reflect.apply(e[n],e,arguments),(l=t.get(r))&&(o.get(l).revoke(),r=l);for(let r,n,l=0,a=e.length;l<a;l++)(r=e[l])&&"object"==typeof r&&((n=o.get(t.get(r)))?n.ownKey=l:console.error("unexpectedly failed to resolve proxy -> target -> observed"));return f.notify([{type:"delete",path:a.path.concat(0),oldValue:r}]),r}:"unshift"===n?function(){let r,l,p,s=[];(r=Array.from(arguments)).forEach((e,t)=>{e&&"object"==typeof e&&(r[t]=new i(e,t,a).proxy)}),l=Reflect.apply(e[n],e,r);for(let r,n=0,l=e.length;n<l;n++)(r=e[n])&&"object"==typeof r&&((p=o.get(t.get(r)))?p.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));for(let t=0,o=r.length;t<o;t++)s.push({type:"insert",path:a.path.concat(t),value:e[t]});return f.notify(s),l}:"reverse"===n?function(){let r;Reflect.apply(e[n],e,arguments);for(let n,l=0,a=e.length;l<a;l++)(n=e[l])&&"object"==typeof n&&((r=o.get(t.get(n)))?r.ownKey=l:console.error("failed to resolve proxy -> target -> observed"));return f.notify([{type:"reverse"}]),this}:"sort"===n?function(){let r;Reflect.apply(e[n],e,arguments);for(let n,l=0,a=e.length;l<a;l++)(n=e[l])&&"object"==typeof n&&((r=o.get(t.get(n)))?r.ownKey=l:console.error("failed to resolve proxy -> target -> observed"));return f.notify([{type:"shuffle"}]),this}:"fill"===n?function(){let r,l,p,s=[],c=arguments.length,y=e.length;r=c<2?0:arguments[1]<0?y+arguments[1]:arguments[1],l=c<3?y:arguments[2]<0?y+arguments[2]:arguments[2],p=e.slice(),Reflect.apply(e[n],e,arguments);for(let n,f,c=r;c<l;c++)(n=e[c])&&"object"==typeof n&&(e[c]=new i(n,c,a).proxy),p.hasOwnProperty(c)?((f=t.get(p[c]))&&o.get(f).revoke(),s.push({type:"update",path:a.path.concat(c),value:e[c],oldValue:f||p[c]})):s.push({type:"insert",path:a.path.concat(c),value:e[c]});return f.notify(s),this}:"splice"===n?function(){let r,l,p,s,c,y,h,u,g=[],b=e.length;h=(r=Array.from(arguments)).length;for(let e,t=0;t<h;t++)e=r[t],t>1&&e&&"object"==typeof e&&(r[t]=new i(e,t,a).proxy);s=0===h?0:r[0]<0?b+r[0]:r[0],c=h<2?b-s:r[1],y=Math.max(h-2,0),l=Reflect.apply(e[n],e,r),b=e.length;for(let r,n=0;n<b;n++)(r=e[n])&&"object"==typeof r&&((p=o.get(t.get(r)))?p.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));for(let e,r,n=0,a=l.length;n<a;n++)e=l[n],(r=t.get(e))&&(o.get(r).revoke(),l[n]=r);for(u=0;u<c;u++)u<y?g.push({type:"update",path:a.path.concat(s+u),value:e[s+u],oldValue:l[u]}):g.push({type:"delete",path:a.path.concat(s+u),oldValue:l[u]});for(;u<y;u++)g.push({type:"insert",path:a.path.concat(s+u),value:e[s+u]});return f.notify(g),l}:Reflect.get(e,n)}function f(e,n,a){let f,p=e[n],s=o.get(e),c=r.get(s.root);if(f=a&&"object"==typeof a&&!l(a)?Reflect.set(e,n,new i(a,n,s).proxy):Reflect.set(e,n,a)){if(p){let e=t.get(p);e&&(o.get(e).revoke(),p=e)}if(c.hasListeners()&&!s.preventCallbacks){let e,t=s.path,o=t.length,r=new Array(o+1);for(e=0;e<o;e++)r[e]=t[e];r[o]=n,c.notify([void 0!==p?{type:"update",path:r,value:a,oldValue:p}:{type:"insert",path:r,value:a}])}}return f}function p(e,n){let l,a=e[n],f=o.get(e),p=r.get(f.root);if(l=Reflect.deleteProperty(e,n)){if(a){let e=t.get(a);e&&(o.get(e).revoke(),a=e)}if(p.hasListeners()&&!f.preventCallbacks){let e,t=f.path,o=t.length,r=new Array(o+1);for(e=0;e<o;e++)r[e]=t[e];r[o]=n,p.notify([{type:"delete",path:r,oldValue:a}])}}return l}function i(e,r,n){let s;var c;Array.isArray(e)?(function(e,t){let o,r=0,n=e.length;for(;r<n;r++)(o=e[r])&&"object"==typeof o&&!l(o)&&(e[r]=new i(o,r,t).proxy)}(s=function(e){let t=0,o=e.length,r=new Array(o);for(;t<o;t++)r[t]=e[t];return r}(e),this),this.revokable=Proxy.revocable(s,{set:f,get:a,deleteProperty:p})):(c=e,function(e,t){let o,r,n=Object.keys(e),a=n.length;for(;a--;)(r=e[o=n[a]])&&"object"==typeof r&&!l(r)&&(e[o]=new i(r,o,t).proxy)}(s=Object.assign({},c),this),this.revokable=Proxy.revocable(s,{set:f,deleteProperty:p})),this.targetClone=s,this.proxy=this.revokable.proxy,this.ownKey=r,this.parent=n,o.set(s,this),t.set(this.proxy,s)}function s(e){let t=!1,o=[];e.targetClone.observe=function(e){if(t)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");o.indexOf(e)<0?o.push(e):console.info("observer (callback) may be bound to an observable only once")},e.targetClone.unobserve=function(){if(t)throw new TypeError("revoked Observable MAY NOT be unobserved anymore");if(arguments.length)for(let e,t=0,r=arguments.length;t<r;t++)(e=o.indexOf(arguments[t]))>=0&&o.splice(e,1);else o.splice(0,o.length)},e.targetClone.revoke=function(){t?console.log("revoking of Observable effective only once"):(t=!0,e.revoke())},this.hasListeners=function(){return o.length>0},this.notify=function(e){let t=o.length;for(;t--;)try{o[t](e)}catch(e){console.error("one/some of the observing callbacks failed with ",e)}}}Object.defineProperty(i.prototype,"root",{get:function(){let e=this;for(;e.parent;)e=e.parent;return e}}),Object.defineProperty(i.prototype,"path",{get:function(){let e=[],t=[],o=0,r=0,n=this;for(;void 0!==n.ownKey;)e[o++]=n.ownKey,n=n.parent;for(;o--;)t[r++]=e[o];return t}}),Object.defineProperty(i.prototype,"revoke",{value:function(){let e=t.get(this.proxy),r=Object.keys(e);this.revokable.revoke();for(let n,l,a=0,f=r.length;a<f;a++)n=r[a],(l=t.get(e[n]))&&(e[n]=o.get(l).revoke());return t.delete(this.proxy),o.delete(e),e}}),Object.defineProperty(s,"from",{value:function(e){if(!(!e||"object"!=typeof e||l(e)||"observe"in e||"unobserve"in e||"revoke"in e)){let t=new i(e),o=new s(t);return r.set(t,o),t.proxy}if(!e||"object"!=typeof e)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in e||"unobserve"in e||"revoke"in e)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(l(e))throw new Error(e+" found to be one of non-observable object types: "+n)}}),Object.defineProperty(e,"Observable",{value:s})})();